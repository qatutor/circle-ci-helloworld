version: 2
jobs:
  build:
    docker:
      - image: gcc:8.1.0
    working_directory: ~/work
    steps:
      - checkout
      - run:
          name: create report folder
          command: |
             mkdir -p ~/work/cucumber
             touch ~/work/cucumber/report.txt
             echo "my testing notes" > ~/work/cucumber/report.txt

      - store_artifacts:
          path: ~/work/cucumber
      - run:
              name: Send text report
              command: | 
                # export CIRCLE_TOKEN=':6d6d10b9c323092981112c649e9f51492b6f51fd'
                # curl https://circleci.com/api/v1.1/project/:vcs-type/:username/:project/:build_num/artifacts?circle-token=$CIRCLE_TOKEN | grep -o 'https://[^"]*' > artifacts.txt
                # <artifacts.txt xargs -P4 -I % wget %?circle-token=$CIRCLE_TOKEN
                cd cucumber
                ls -al
                curl -X POST -H 'Content-type: application/json' --data '{"text":"This is a link https://google.com "}' https://hooks.slack.com/services/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